set(LTJS_TARGET ltjs_lib_d3d_render)

include(ltjs_common)

ltjs_add_default_options(precompile.h)

add_definitions(-D__D3DREND)
add_definitions(-D__D3D)
add_definitions(-DMODEL_SUPPORT_ABC)

include_directories(
    ../../../../../../directx/include
    ../../../../client/src
    .
    ../../../../kernel/mem/src
    ../../../../shared/src
    ../../../../kernel/src
    ../../../../../sdk/inc
    ../../../../../../libs/stdlith
    ../../../../shared/src/sys/win
    ../../../../world/src
    ../../../../model/src
    ../../../../model/src/sys/d3d
    ../../../../kernel/src/sys/win
    ../../../../kernel/io/src
    ../../../../lithtemplate
    ../../../../../sdk/inc/physics
)

set(
    HDRS
    ../shadows/d3dshadowtexture.h
    iaggregateshader.h
    modelshadowshader.h
    texturescriptdefs.h
    texturescriptevaluator.h
    texturescriptinstance.h
    texturescriptinterpreter.h
    texturescriptmgr.h
    texturescriptvarmgr.h
    3d_ops.h
    aabb.h
    ../../../../model/src/animtracker.h
    ../../../../shared/src/bdefs.h
    ../../../../client/src/client_formatmgr.h
    clipline.h
    ../../../../shared/src/colorops.h
    common_draw.h
    common_init.h
    common_stuff.h
    ../../../../shared/src/conparse.h
    ../../../../kernel/src/sys/win/counter.h
    d3d_convar.h
    d3d_defs.h
    d3d_device.h
    d3d_device_wrapper.h
    d3d_draw.h
    d3d_init.h
    d3d_renderblock.h
    d3d_rendershader.h
    d3d_rendershader_base.h
    d3d_rendershader_default.h
    d3d_rendershader_dynamiclight.h
    d3d_rendershader_glow.h
    d3d_rendershader_gouraud.h
    d3d_rendershader_gouraud_fullbright.h
    d3d_rendershader_lightmap.h
    d3d_renderstatemgr.h
    d3d_renderstyle.h
    d3d_renderstyleinterface.h
    d3d_renderworld.h
    d3d_renderworld_occluder.h
    d3d_shell.h
    d3d_surface.h
    d3d_texture.h
    d3d_utils.h
    d3d_viewparams.h
    ../../../../shared/src/sys/win/d3dddstructs.h
    d3dmeshrendobj_rigid.h
    d3dmeshrendobj_skel.h
    d3dmeshrendobj_vertanim.h
    ../../../../world/src/de_mainworld.h
    ../../../../kernel/mem/src/de_memory.h
    ../../../../world/src/de_objects.h
    ../../../../world/src/de_sprite.h
    ../../../../world/src/de_world.h
    ../../../../shared/src/debuggeometry.h
    devicelightlist.h
    dirtyrect.h
    draw_canvas.h
    drawlight.h
    drawobjects.h
    drawsky.h
    drawworldmodel.h
    ../../../../kernel/src/dsys.h
    ../../../../kernel/src/sys/win/dsys_interface.h
    ../../../../shared/src/dtxmgr.h
    fixedpoint.h
    ../../../../world/src/fullintersectline.h
    ../../../../shared/src/gamemath.h
    ../../../../shared/src/geometry.h
    ../../../../shared/src/geomroutines.h
    ../../../../../sdk/inc/iclientshell.h
    ../../../../../sdk/inc/iltbenchmark.h
    ../../../../../sdk/inc/iltclient.h
    ../../../../../sdk/inc/iltcommon.h
    ../../../../../sdk/inc/iltcsbase.h
    ../../../../../sdk/inc/iltdirectmusic.h
    ../../../../../sdk/inc/iltdrawprim.h
    ../../../../../sdk/inc/iltinfo.h
    ../../../../../sdk/inc/iltmath.h
    ../../../../../sdk/inc/iltrenderstyles.h
    ../../../../../sdk/inc/iltsoundmgr.h
    ../../../../../sdk/inc/iltspritecontrol.h
    ../../../../../sdk/inc/iltstream.h
    ../../../../../sdk/inc/ilttexinterface.h
    ../../../../kernel/src/sys/win/interface_helpers.h
    ../../../../world/src/intersect_line.h
    ../../../../world/src/light_table.h
    ../../../../shared/src/lightmap_compress.h
    ../../../../../sdk/inc/lithtech.h
    ../../../../../sdk/inc/ltanimtracker.h
    ../../../../../sdk/inc/ltassert.h
    ../../../../model/src/ltb.h
    ../../../../../sdk/inc/ltbasedefs.h
    ../../../../../sdk/inc/ltbasetypes.h
    ../../../../../sdk/inc/ltcodes.h
    lteffectimpl.h
    lteffectinclude.h
    lteffectshadermgr.h
    ../../../../kernel/src/sys/win/lthread.h
    ../../../../../sdk/inc/ltinteger.h
    ../../../../../sdk/inc/ltlink.h
    ../../../../../sdk/inc/ltmatrix.h
    ../../../../../sdk/inc/ltmodule.h
    ltpixelshadermgr.h
    ../../../../../sdk/inc/ltplane.h
    ../../../../../sdk/inc/ltpvalue.h
    ../../../../../sdk/inc/ltquatbase.h
    ../../../../../sdk/inc/ltrect.h
    ../../../../../sdk/inc/ltrenderstyle.h
    ../../../../../sdk/inc/ltrotation.h
    ltshaderdevicestateimp.h
    ../../../../../sdk/inc/ltvector.h
    ltvertexshadermgr.h
    memstats_world.h
    ../../../../model/src/model.h
    ../../../../model/src/model_ops.h
    ../../../../model/src/modelallocations.h
    modeldebug.h
    ../../../../shared/src/nexus.h
    objectgroupmgr.h
    ../../../../shared/src/objectmgr.h
    ../../../../shared/src/pixelformat.h
    polyclip.h
    precompile.h
    relevantlightlist.h
    ../../../../kernel/src/sys/win/render.h
    rendererconsolevars.h
    rendererframestats.h
    ../../../../shared/src/renderinfostruct.h
    renderlight.h
    rendermodelinfolist.h
    rendermodelpiecelist.h
    ../../../../shared/src/renderobject.h
    rendershadowlist.h
    ../../../../shared/src/sys/win/renderstruct.h
    renderstylelookuptables.h
    renderstylemap.h
    rendertarget.h
    rendertargetmgr.h
    screenglowmgr.h
    setupmodel.h
    setuptouchinglights.h
    simd_utilities.h
    ../../../../kernel/src/syscounter.h
    ../../../../shared/src/sysddstructs.h
    tagnodes.h
    ../../../../model/src/transformmaker.h
    ../../../../shared/src/version_info.h
    vertexbuffercontroller.h
    ../../../../world/src/world_tree.h
    ../../../../world/src/worldtreehelper.h
    ltjs_d3d9_device_mutex.h
    ltjs_d3d9_device_mutex_guard.h
    ltjs_d3d9_device9_impl.h
    ltjs_d3d9_exception.h
    ltjs_d3d9_fvf.h
    ltjs_d3d9_id3d9_impl.h
    ltjs_d3d9_index_buffer9_impl.h
    ltjs_d3d9_surface9_impl.h
    ltjs_d3d9_texture9_impl.h
    ltjs_d3d9_unknown_impl.h
    ltjs_d3d9_vertex_buffer9_impl.h
    ltjs_d3d9_vertex_declaration9_impl.h
    ltjs_d3d9_wrapper.h
    GL/glcorearb.h
)

set(
    SRCS
    3d_ops.cpp
    aabb.cpp
    common_draw.cpp
    common_init.cpp
    common_stuff.cpp
    d3d_device.cpp
    d3d_device_wrapper.cpp
    d3d_draw.cpp
    d3d_drawsky.cpp
    d3d_init.cpp
    d3d_optimizedsurface.cpp
    d3d_renderblock.cpp
    d3d_rendershader_dynamiclight.cpp
    d3d_rendershader_glow.cpp
    d3d_rendershader_gouraud.cpp
    d3d_rendershader_gouraud_fullbright.cpp
    d3d_rendershader_lightmap.cpp
    d3d_renderstatemgr.cpp
    d3d_renderstyle.cpp
    d3d_renderstyleinterface.cpp
    d3d_renderworld.cpp
    d3d_renderworld_occluder.cpp
    d3d_shell.cpp
    d3d_surface.cpp
    d3d_texture.cpp
    d3d_utils.cpp
    d3d_viewparams.cpp
    d3dmeshrendobj_rigid.cpp
    d3dmeshrendobj_skel.cpp
    d3dmeshrendobj_vertanim.cpp
    devicelightlist.cpp
    dirtyrect.cpp
    draw_canvas.cpp
    drawlight.cpp
    drawlinesystem.cpp
    drawmodel.cpp
    drawobjects.cpp
    drawparticles.cpp
    drawparticles_a.cpp
    drawpolygrid.cpp
    drawsky.cpp
    drawsprite.cpp
    drawvolumeeffects.cpp
    drawworldmodel.cpp
    lteffectimpl.cpp
    lteffectinclude.cpp
    lteffectshadermgr.cpp
    ltpixelshadermgr.cpp
    ltshaderdevicestateimp.cpp
    ltvertexshadermgr.cpp
    memstats_world.cpp
    modeldebug.cpp
    objectgroupmgr.cpp
    precompile.cpp
    relevantlightlist.cpp
    rendererconsolevars.cpp
    rendererframestats.cpp
    renderlight.cpp
    rendermodelinfolist.cpp
    rendermodelpiecelist.cpp
    rendershadowlist.cpp
    renderstylelookuptables.cpp
    renderstylemap.cpp
    rendertarget.cpp
    rendertargetmgr.cpp
    screenglowmgr.cpp
    setupmodel.cpp
    setuptouchinglights.cpp
    tagnodes.cpp
    vertexbuffercontroller.cpp
    ../shadows/d3dshadowtexture.cpp
    modelshadowshader.cpp
    texturescriptinstance.cpp
    texturescriptinterpreter.cpp
    texturescriptmgr.cpp
    texturescriptvarmgr.cpp
    ltjs_d3d9_device_mutex.cpp
    ltjs_d3d9_device_mutex_guard.cpp
    ltjs_d3d9_device9_impl.cpp
    ltjs_d3d9_dsurface9_impl.cpp
    ltjs_d3d9_exception.cpp
    ltjs_d3d9_fvf.cpp
    ltjs_d3d9_id3d9_impl.cpp
    ltjs_d3d9_index_buffer9_impl.cpp
    ltjs_d3d9_texture9_impl.cpp
    ltjs_d3d9_unknown_impl.cpp
    ltjs_d3d9_vertex_buffer9_impl.cpp
    ltjs_d3d9_vertex_declaration9_impl.cpp
    ltjs_d3d9_wrapper.cpp
    ltjs_d3d9_wrapper_d3d9.cpp
    ltjs_d3d9_wrapper_ogl.cpp
)

if (MSVC)
    set_source_files_properties(
        precompile.cpp
        PROPERTIES
            # Precompiled Header (Create)
            COMPILE_FLAGS -Yc
    )
endif ()

add_library(
    ${LTJS_TARGET} STATIC
    ${HDRS}
    ${SRCS}
)
